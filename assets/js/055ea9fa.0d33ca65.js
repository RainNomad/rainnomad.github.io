"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[2157],{1103:(r,e,n)=>{n.r(e),n.d(e,{assets:()=>c,contentTitle:()=>i,default:()=>u,frontMatter:()=>s,metadata:()=>t,toc:()=>h});const t=JSON.parse('{"id":"VUE-\u7b14\u8bb0/Vue\u8def\u7531Hash\u6a21\u5f0f\u5206\u6790","title":"Vue\u8def\u7531Hash\u6a21\u5f0f\u5206\u6790","description":"Vue-router\u662fVue\u7684\u6838\u5fc3\u7ec4\u4ef6\uff0c\u4e3b\u8981\u662f\u4f5c\u4e3aVue\u7684\u8def\u7531\u7ba1\u7406\u5668\uff0cVue-router\u9ed8\u8ba4hash\u6a21\u5f0f\uff0c\u5373\u4f7f\u7528URL\u7684Hash\u6765\u6a21\u62df\u4e00\u4e2a\u5b8c\u6574\u7684URL\uff0c\u5f53URL\u6539\u53d8\u65f6\u9875\u9762\u4e0d\u4f1a\u91cd\u65b0\u52a0\u8f7d\u3002","source":"@site/docs/VUE-\u7b14\u8bb0/Vue\u8def\u7531Hash\u6a21\u5f0f\u5206\u6790.md","sourceDirName":"VUE-\u7b14\u8bb0","slug":"/VUE-\u7b14\u8bb0/Vue\u8def\u7531Hash\u6a21\u5f0f\u5206\u6790","permalink":"/docs/VUE-\u7b14\u8bb0/Vue\u8def\u7531Hash\u6a21\u5f0f\u5206\u6790","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/VUE-\u7b14\u8bb0/Vue\u8def\u7531Hash\u6a21\u5f0f\u5206\u6790.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Vue\u751f\u547d\u5468\u671f","permalink":"/docs/VUE-\u7b14\u8bb0/Vue\u751f\u547d\u5468\u671f"},"next":{"title":"Vue\u8def\u7531History\u6a21\u5f0f\u5206\u6790","permalink":"/docs/VUE-\u7b14\u8bb0/Vue\u8def\u7531History\u6a21\u5f0f\u5206\u6790"}}');var o=n(4848),a=n(8453);const s={},i="Vue\u8def\u7531Hash\u6a21\u5f0f\u5206\u6790",c={},h=[{value:"\u63cf\u8ff0",id:"\u63cf\u8ff0",level:2},{value:"\u5206\u6790",id:"\u5206\u6790",level:2},{value:"\u6bcf\u65e5\u4e00\u9898",id:"\u6bcf\u65e5\u4e00\u9898",level:2},{value:"\u53c2\u8003",id:"\u53c2\u8003",level:2}];function d(r){const e={br:"br",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,a.R)(),...r.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e.header,{children:(0,o.jsx)(e.h1,{id:"vue\u8def\u7531hash\u6a21\u5f0f\u5206\u6790",children:"Vue\u8def\u7531Hash\u6a21\u5f0f\u5206\u6790"})}),"\n",(0,o.jsxs)(e.p,{children:[(0,o.jsx)(e.code,{children:"Vue-router"}),"\u662f",(0,o.jsx)(e.code,{children:"Vue"}),"\u7684\u6838\u5fc3\u7ec4\u4ef6\uff0c\u4e3b\u8981\u662f\u4f5c\u4e3a",(0,o.jsx)(e.code,{children:"Vue"}),"\u7684\u8def\u7531\u7ba1\u7406\u5668\uff0c",(0,o.jsx)(e.code,{children:"Vue-router"}),"\u9ed8\u8ba4",(0,o.jsx)(e.code,{children:"hash"}),"\u6a21\u5f0f\uff0c\u5373\u4f7f\u7528",(0,o.jsx)(e.code,{children:"URL"}),"\u7684",(0,o.jsx)(e.code,{children:"Hash"}),"\u6765\u6a21\u62df\u4e00\u4e2a\u5b8c\u6574\u7684",(0,o.jsx)(e.code,{children:"URL"}),"\uff0c\u5f53",(0,o.jsx)(e.code,{children:"URL"}),"\u6539\u53d8\u65f6\u9875\u9762\u4e0d\u4f1a\u91cd\u65b0\u52a0\u8f7d\u3002"]}),"\n",(0,o.jsx)(e.h2,{id:"\u63cf\u8ff0",children:"\u63cf\u8ff0"}),"\n",(0,o.jsxs)(e.p,{children:[(0,o.jsx)(e.code,{children:"Hash"}),"\u7b26\u53f7\u5373",(0,o.jsx)(e.code,{children:"#"}),"\u539f\u672c\u7684\u76ee\u7684\u662f\u7528\u6765\u6307\u793a",(0,o.jsx)(e.code,{children:"URL"}),"\u4e2d\u6307\u793a\u7f51\u9875\u4e2d\u7684\u4f4d\u7f6e\uff0c\u4f8b\u5982",(0,o.jsx)(e.code,{children:"https://www.example.com/index.html#print"}),"\u5373\u4ee3\u8868",(0,o.jsx)(e.code,{children:"example"}),"\u7684",(0,o.jsx)(e.code,{children:"index.html"}),"\u7684",(0,o.jsx)(e.code,{children:"print"}),"\u4f4d\u7f6e\uff0c\u6d4f\u89c8\u5668\u8bfb\u53d6\u8fd9\u4e2a",(0,o.jsx)(e.code,{children:"URL"}),"\u540e\uff0c\u4f1a\u81ea\u52a8\u5c06",(0,o.jsx)(e.code,{children:"print"}),"\u4f4d\u7f6e\u6eda\u52a8\u81f3\u53ef\u89c6\u533a\u57df\uff0c\u901a\u5e38\u4f7f\u7528",(0,o.jsx)(e.code,{children:"<a>"}),"\u6807\u7b7e\u7684",(0,o.jsx)(e.code,{children:"name"}),"\u5c5e\u6027\u6216\u8005",(0,o.jsx)(e.code,{children:"<div>"}),"\u6807\u7b7e\u7684",(0,o.jsx)(e.code,{children:"id"}),"\u5c5e\u6027\u6307\u5b9a\u951a\u70b9\u3002",(0,o.jsx)(e.br,{}),"\n","\u901a\u8fc7",(0,o.jsx)(e.code,{children:"window.location.hash"}),"\u5c5e\u6027\u80fd\u591f\u8bfb\u53d6\u951a\u70b9\u4f4d\u7f6e\uff0c\u53ef\u4ee5\u4e3a",(0,o.jsx)(e.code,{children:"Hash"}),"\u7684\u6539\u53d8\u6dfb\u52a0",(0,o.jsx)(e.code,{children:"hashchange"}),"\u76d1\u542c\u4e8b\u4ef6\uff0c\u6bcf\u4e00\u6b21\u6539\u53d8",(0,o.jsx)(e.code,{children:"Hash"}),"\uff0c\u90fd\u4f1a\u5728\u6d4f\u89c8\u5668\u7684\u8bbf\u95ee\u5386\u53f2\u4e2d\u589e\u52a0\u4e00\u4e2a\u8bb0\u5f55\uff0c\u6b64\u5916",(0,o.jsx)(e.code,{children:"Hash"}),"\u867d\u7136\u51fa\u73b0\u5728",(0,o.jsx)(e.code,{children:"URL"}),"\u4e2d\uff0c\u4f46\u4e0d\u4f1a\u88ab\u5305\u62ec\u5728",(0,o.jsx)(e.code,{children:"HTTP"}),"\u8bf7\u6c42\u4e2d\uff0c\u5373",(0,o.jsx)(e.code,{children:"#"}),"\u53ca\u4e4b\u540e\u7684\u5b57\u7b26\u4e0d\u4f1a\u88ab\u53d1\u9001\u5230\u670d\u52a1\u7aef\u8fdb\u884c\u8d44\u6e90\u6216\u6570\u636e\u7684\u8bf7\u6c42\uff0c\u5176\u662f\u7528\u6765\u6307\u5bfc\u6d4f\u89c8\u5668\u52a8\u4f5c\u7684\uff0c\u5bf9\u670d\u52a1\u5668\u7aef\u6ca1\u6709\u6548\u679c\uff0c\u56e0\u6b64\u6539\u53d8",(0,o.jsx)(e.code,{children:"Hash"}),"\u4e0d\u4f1a\u91cd\u65b0\u52a0\u8f7d\u9875\u9762\u3002",(0,o.jsx)(e.br,{}),"\n",(0,o.jsx)(e.code,{children:"Vue-router"}),"\u7684\u4f5c\u7528\u5c31\u662f\u901a\u8fc7\u6539\u53d8",(0,o.jsx)(e.code,{children:"URL"}),"\uff0c\u5728\u4e0d\u91cd\u65b0\u8bf7\u6c42\u9875\u9762\u7684\u60c5\u51b5\u4e0b\uff0c\u66f4\u65b0\u9875\u9762\u89c6\u56fe\uff0c\u4ece\u800c\u52a8\u6001\u52a0\u8f7d\u4e0e\u9500\u6bc1\u7ec4\u4ef6\uff0c\u7b80\u5355\u7684\u8bf4\u5c31\u662f\uff0c\u867d\u7136\u5730\u5740\u680f\u7684\u5730\u5740\u6539\u53d8\u4e86\uff0c\u4f46\u662f\u5e76\u4e0d\u662f\u4e00\u4e2a\u5168\u65b0\u7684\u9875\u9762\uff0c\u800c\u662f\u4e4b\u524d\u7684\u9875\u9762\u67d0\u4e9b\u90e8\u5206\u8fdb\u884c\u4e86\u4fee\u6539\uff0c\u8fd9\u4e5f\u662f",(0,o.jsx)(e.code,{children:"SPA"}),"\u5355\u9875\u5e94\u7528\u7684\u7279\u70b9\uff0c\u5176\u6240\u6709\u7684\u6d3b\u52a8\u5c40\u9650\u4e8e\u4e00\u4e2a",(0,o.jsx)(e.code,{children:"Web"}),"\u9875\u9762\u4e2d\uff0c\u975e\u61d2\u52a0\u8f7d\u7684\u9875\u9762\u4ec5\u5728\u8be5",(0,o.jsx)(e.code,{children:"Web"}),"\u9875\u9762\u521d\u59cb\u5316\u65f6\u52a0\u8f7d\u76f8\u5e94\u7684",(0,o.jsx)(e.code,{children:"HTML"}),"\u3001",(0,o.jsx)(e.code,{children:"JavaScript"}),"\u3001",(0,o.jsx)(e.code,{children:"CSS"}),"\u6587\u4ef6\uff0c\u4e00\u65e6\u9875\u9762\u52a0\u8f7d\u5b8c\u6210\uff0c",(0,o.jsx)(e.code,{children:"SPA"}),"\u4e0d\u4f1a\u8fdb\u884c\u9875\u9762\u7684\u91cd\u65b0\u52a0\u8f7d\u6216\u8df3\u8f6c\uff0c\u800c\u662f\u5229\u7528",(0,o.jsx)(e.code,{children:"JavaScript"}),"\u52a8\u6001\u7684\u53d8\u6362",(0,o.jsx)(e.code,{children:"HTML"}),"\uff0c\u9ed8\u8ba4",(0,o.jsx)(e.code,{children:"Hash"}),"\u6a21\u5f0f\u662f\u901a\u8fc7\u951a\u70b9\u5b9e\u73b0\u8def\u7531\u4ee5\u53ca\u63a7\u5236\u7ec4\u4ef6\u7684\u663e\u793a\u4e0e\u9690\u85cf\u6765\u5b9e\u73b0\u7c7b\u4f3c\u4e8e\u9875\u9762\u8df3\u8f6c\u7684\u4ea4\u4e92\u3002"]}),"\n",(0,o.jsx)(e.h2,{id:"\u5206\u6790",children:"\u5206\u6790"}),"\n",(0,o.jsxs)(e.p,{children:[(0,o.jsx)(e.code,{children:"Vue-router"}),"\u6e90\u7801\u7684\u5b9e\u73b0\u6bd4\u8f83\u590d\u6742\uff0c\u4f1a\u5904\u7406\u5404\u79cd\u517c\u5bb9\u95ee\u9898\u4e0e\u5f02\u5e38\u4ee5\u53ca\u5404\u79cd\u6761\u4ef6\u5206\u652f\uff0c\u6587\u7ae0\u5206\u6790\u6bd4\u8f83\u6838\u5fc3\u7684\u4ee3\u7801\u90e8\u5206\uff0c\u7cbe\u7b80\u8fc7\u540e\u7684\u7248\u672c\uff0c\u91cd\u8981\u90e8\u5206\u505a\u51fa\u6ce8\u91ca\uff0c",(0,o.jsx)(e.code,{children:"commit id"}),"\u4e3a",(0,o.jsx)(e.code,{children:"560d11d"}),"\u3002"]}),"\n",(0,o.jsxs)(e.p,{children:["\u9996\u5148\u662f\u5728\u5b9a\u4e49",(0,o.jsx)(e.code,{children:"Router"}),"\u65f6\u8c03\u7528",(0,o.jsx)(e.code,{children:"Vue.use(VueRouter)"}),"\uff0c\u6b64\u65f6\u4f1a\u8c03\u7528",(0,o.jsx)(e.code,{children:"VueRouter"}),"\u7c7b\u4e0a\u7684\u9759\u6001\u65b9\u6cd5\uff0c\u5373",(0,o.jsx)(e.code,{children:"VueRouter.install = install"}),"\uff0c",(0,o.jsx)(e.code,{children:"install"}),"\u6a21\u5757\u4e3b\u8981\u662f\u4fdd\u8bc1",(0,o.jsx)(e.code,{children:"Vue-router"}),"\u53ea\u88ab",(0,o.jsx)(e.code,{children:"use"}),"\u4e00\u6b21\uff0c\u4ee5\u53ca\u901a\u8fc7",(0,o.jsx)(e.code,{children:"mixin"}),"\u5728",(0,o.jsx)(e.code,{children:"Vue"}),"\u7684\u751f\u547d\u5468\u671f",(0,o.jsx)(e.code,{children:"beforeCreate"}),"\u5185\u6ce8\u518c\u5b9e\u4f8b\uff0c\u5728",(0,o.jsx)(e.code,{children:"destroyed"}),"\u5185\u9500\u6bc1\u5b9e\u4f8b\uff0c\u8fd8\u6709\u5b9a\u4e49",(0,o.jsx)(e.code,{children:"$router"}),"\u4e0e",(0,o.jsx)(e.code,{children:"$route"}),"\u5c5e\u6027\u4e3a\u53ea\u8bfb\u5c5e\u6027\u4ee5\u53ca",(0,o.jsx)(e.code,{children:"<router-view>"}),"\u4e0e",(0,o.jsx)(e.code,{children:"<router-link>"}),"\u5168\u5c40\u7ec4\u4ef6\u7684\u6ce8\u518c\u3002"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-javascript",children:"// dev/src/install.js line 6\r\nexport function install (Vue) {\r\n  if (install.installed && _Vue === Vue) return\r\n  install.installed = true // \u4fdd\u8bc1 Vue-router \u53ea\u88ab use \u4e00\u6b21\r\n\r\n  _Vue = Vue\r\n\r\n  const isDef = v => v !== undefined\r\n\r\n  const registerInstance = (vm, callVal) => {\r\n    let i = vm.$options._parentVnode\r\n    if (isDef(i) && isDef(i = i.data) && isDef(i = i.registerRouteInstance)) {\r\n      i(vm, callVal)\r\n    }\r\n  }\r\n\r\n  Vue.mixin({\r\n    beforeCreate () { // \u6ce8\u518c\u5b9e\u4f8b\r\n      if (isDef(this.$options.router)) { // this.$options.router \u6765\u81ea\u4e8e VueRouter \u7684\u5b9e\u4f8b\u5316 // \u5224\u65ad\u5b9e\u4f8b\u662f\u5426\u5df2\u7ecf\u6302\u8f7d\r\n        this._routerRoot = this\r\n        this._router = this.$options.router\r\n        this._router.init(this) // // \u8c03\u7528 VueRouter \u7684 init \u65b9\u6cd5\r\n        Vue.util.defineReactive(this, '_route', this._router.history.current)\r\n      } else {\r\n        this._routerRoot = (this.$parent && this.$parent._routerRoot) || this // \u5c06\u7ec4\u4ef6\u7684 _routerRoot \u90fd\u6307\u5411\u6839 Vue \u5b9e\u4f8b\r\n      }\r\n      registerInstance(this, this)\r\n    },\r\n    destroyed () { // \u9500\u6bc1\u5b9e\u4f8b \u5373\u6302\u8f7dundefined\r\n      registerInstance(this)\r\n    }\r\n  })\r\n\r\n  Object.defineProperty(Vue.prototype, '$router', {\r\n    get () { return this._routerRoot._router }\r\n  })\r\n\r\n  Object.defineProperty(Vue.prototype, '$route', {\r\n    get () { return this._routerRoot._route }\r\n  })\r\n\r\n  Vue.component('RouterView', View) // \u6ce8\u518c\u5168\u5c40\u7ec4\u4ef6 <router-view>\r\n  Vue.component('RouterLink', Link) // \u6ce8\u518c\u5168\u5c40\u7ec4\u4ef6 <router-link>\r\n\r\n  const strats = Vue.config.optionMergeStrategies\r\n  // use the same hook merging strategy for route hooks\r\n  strats.beforeRouteEnter = strats.beforeRouteLeave = strats.beforeRouteUpdate = strats.created\r\n}\n"})}),"\n",(0,o.jsxs)(e.p,{children:["\u4e4b\u540e\u662f",(0,o.jsx)(e.code,{children:"VueRouter"}),"\u5bf9\u8c61\u7684\u6784\u9020\u51fd\u6570\uff0c\u4e3b\u8981\u662f\u5148\u83b7\u53d6",(0,o.jsx)(e.code,{children:"mode"}),"\u7684\u503c\uff0c\u5982\u679c",(0,o.jsx)(e.code,{children:"mode"}),"\u7684\u503c\u4e3a",(0,o.jsx)(e.code,{children:"history"}),"\u4f46\u662f\u6d4f\u89c8\u5668\u4e0d\u652f\u6301",(0,o.jsx)(e.code,{children:"history"}),"\u6a21\u5f0f,\u90a3\u4e48\u5c31\u5f3a\u5236\u8bbe\u7f6e",(0,o.jsx)(e.code,{children:"mode"}),"\u503c\u4e3a",(0,o.jsx)(e.code,{children:"hash"}),"\uff0c\u63a5\u4e0b\u6765\u6839\u636e",(0,o.jsx)(e.code,{children:"mode"}),"\u7684\u503c\uff0c\u6765\u9009\u62e9",(0,o.jsx)(e.code,{children:"vue-router"}),"\u4f7f\u7528\u54ea\u79cd\u6a21\u5f0f\u3002"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-javascript",children:"// dev/src/index.js line 40\r\nconstructor (options: RouterOptions = {}) {\r\n  this.app = null\r\n  this.apps = []\r\n  this.options = options\r\n  this.beforeHooks = []\r\n  this.resolveHooks = []\r\n  this.afterHooks = []\r\n  this.matcher = createMatcher(options.routes || [], this) // \u521b\u5efa\u8def\u7531\u5339\u914d\u5bf9\u8c61\r\n\r\n  let mode = options.mode || 'hash'\r\n  this.fallback =\r\n    mode === 'history' && !supportsPushState && options.fallback !== false // \u68c0\u8f66\u517c\u5bb9\r\n  if (this.fallback) {\r\n    mode = 'hash'\r\n  }\r\n  if (!inBrowser) {\r\n    mode = 'abstract'\r\n  }\r\n  this.mode = mode\r\n\r\n  switch (mode) {\r\n    case 'history':\r\n      this.history = new HTML5History(this, options.base)\r\n      break\r\n    case 'hash':\r\n      this.history = new HashHistory(this, options.base, this.fallback) // \u5b9e\u4f8b\u5316Hash\u6a21\u5f0f\r\n      break\r\n    case 'abstract':\r\n      this.history = new AbstractHistory(this, options.base)\r\n      break\r\n    default:\r\n      if (process.env.NODE_ENV !== 'production') {\r\n        assert(false, `invalid mode: ${mode}`)\r\n      }\r\n  }\r\n}\n"})}),"\n",(0,o.jsxs)(e.p,{children:["\u5728\u6784\u9020\u51fd\u6570\u4e2d\u8c03\u7528\u4e86\u521b\u5efa\u8def\u7531\u5339\u914d\u5bf9\u8c61\u7684\u65b9\u6cd5",(0,o.jsx)(e.code,{children:"createMatcher"}),"\uff0c\u800c\u5728",(0,o.jsx)(e.code,{children:"createMatcher"}),"\u4e2d\u53c8\u8c03\u7528\u4e86\u5b9e\u9645\u7528\u4ee5\u521b\u5efa\u8def\u7531\u6620\u5c04\u8868\u7684\u65b9\u6cd5",(0,o.jsx)(e.code,{children:"createRouteMap"}),"\uff0c\u53ef\u4ee5\u8bf4",(0,o.jsx)(e.code,{children:"createMatcher"}),"\u51fd\u6570\u7684\u4f5c\u7528\u5c31\u662f\u521b\u5efa\u8def\u7531\u6620\u5c04\u8868\uff0c\u7136\u540e\u901a\u8fc7\u95ed\u5305\u7684\u65b9\u5f0f\u8ba9",(0,o.jsx)(e.code,{children:"addRoutes"}),"\u548c",(0,o.jsx)(e.code,{children:"match"}),"\u51fd\u6570\u80fd\u591f\u4f7f\u7528\u8def\u7531\u6620\u5c04\u8868\u7684\u51e0\u4e2a\u5bf9\u8c61\uff0c\u6700\u540e\u8fd4\u56de\u4e00\u4e2a",(0,o.jsx)(e.code,{children:"Matcher"}),"\u5bf9\u8c61\u3002"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-javascript",children:"// dev/src/create-matcher.js line 16\r\nexport function createMatcher (\r\n  routes: Array<RouteConfig>,\r\n  router: VueRouter\r\n): Matcher {\r\n  const { pathList, pathMap, nameMap } = createRouteMap(routes) // \u521b\u5efa\u8def\u7531\u6620\u5c04\u8868\r\n\r\n  function addRoutes (routes) {\r\n    createRouteMap(routes, pathList, pathMap, nameMap)\r\n  }\r\n\r\n  function match ( // \u8def\u7531\u5339\u914d\r\n    raw: RawLocation,\r\n    currentRoute?: Route,\r\n    redirectedFrom?: Location\r\n  ): Route {\r\n    const location = normalizeLocation(raw, currentRoute, false, router) // location \u662f\u4e00\u4e2a\u5bf9\u8c61\uff0c\u7c7b\u4f3c\u4e8e {\"_normalized\":true,\"path\":\"/\",\"query\":{},\"hash\":\"\"}\r\n    const { name } = location\r\n\r\n    if (name) { // \u5982\u679c\u6709\u8def\u7531\u540d\u79f0 \u5c31\u8fdb\u884cnameMap\u6620\u5c04\r\n      const record = nameMap[name]  // nameMap[name] = \u8def\u7531\u8bb0\u5f55\r\n      if (process.env.NODE_ENV !== 'production') {\r\n        warn(record, `Route with name '${name}' does not exist`)\r\n      }\r\n      if (!record) return _createRoute(null, location)\r\n      const paramNames = record.regex.keys\r\n        .filter(key => !key.optional)\r\n        .map(key => key.name)\r\n\r\n      if (typeof location.params !== 'object') {\r\n        location.params = {}\r\n      }\r\n\r\n      if (currentRoute && typeof currentRoute.params === 'object') {\r\n        for (const key in currentRoute.params) {\r\n          if (!(key in location.params) && paramNames.indexOf(key) > -1) {\r\n            location.params[key] = currentRoute.params[key]\r\n          }\r\n        }\r\n      }\r\n\r\n      location.path = fillParams(record.path, location.params, `named route \"${name}\"`)\r\n      return _createRoute(record, location, redirectedFrom)\r\n    } else if (location.path) { // \u5982\u679c\u8def\u7531\u914d\u7f6e\u4e86path\uff0c\u5230pathList\u548cPathMap\u91cc\u5339\u914d\u5230\u8def\u7531\u8bb0\u5f55 \r\n      location.params = {}\r\n      for (let i = 0; i < pathList.length; i++) {\r\n        const path = pathList[i]\r\n        const record = pathMap[path]\r\n        if (matchRoute(record.regex, location.path, location.params)) {\r\n          return _createRoute(record, location, redirectedFrom)\r\n        }\r\n      }\r\n    }\r\n    // no match\r\n    return _createRoute(null, location)\r\n  }\r\n\r\n  function redirect ( // \u5904\u7406\u91cd\u5b9a\u5411\r\n    record: RouteRecord,\r\n    location: Location\r\n  ): Route {\r\n    const originalRedirect = record.redirect\r\n    let redirect = typeof originalRedirect === 'function'\r\n      ? originalRedirect(createRoute(record, location, null, router))\r\n      : originalRedirect\r\n\r\n    if (typeof redirect === 'string') {\r\n      redirect = { path: redirect }\r\n    }\r\n\r\n    if (!redirect || typeof redirect !== 'object') {\r\n      if (process.env.NODE_ENV !== 'production') {\r\n        warn(\r\n          false, `invalid redirect option: ${JSON.stringify(redirect)}`\r\n        )\r\n      }\r\n      return _createRoute(null, location)\r\n    }\r\n\r\n    const re: Object = redirect\r\n    const { name, path } = re\r\n    let { query, hash, params } = location\r\n    query = re.hasOwnProperty('query') ? re.query : query\r\n    hash = re.hasOwnProperty('hash') ? re.hash : hash\r\n    params = re.hasOwnProperty('params') ? re.params : params\r\n\r\n    if (name) {\r\n      // resolved named direct\r\n      const targetRecord = nameMap[name]\r\n      if (process.env.NODE_ENV !== 'production') {\r\n        assert(targetRecord, `redirect failed: named route \"${name}\" not found.`)\r\n      }\r\n      return match({\r\n        _normalized: true,\r\n        name,\r\n        query,\r\n        hash,\r\n        params\r\n      }, undefined, location)\r\n    } else if (path) {\r\n      // 1. resolve relative redirect\r\n      const rawPath = resolveRecordPath(path, record)\r\n      // 2. resolve params\r\n      const resolvedPath = fillParams(rawPath, params, `redirect route with path \"${rawPath}\"`)\r\n      // 3. rematch with existing query and hash\r\n      return match({\r\n        _normalized: true,\r\n        path: resolvedPath,\r\n        query,\r\n        hash\r\n      }, undefined, location)\r\n    } else {\r\n      if (process.env.NODE_ENV !== 'production') {\r\n        warn(false, `invalid redirect option: ${JSON.stringify(redirect)}`)\r\n      }\r\n      return _createRoute(null, location)\r\n    }\r\n  }\r\n\r\n  function alias ( // \u5904\u7406\u522b\u540d\r\n    record: RouteRecord,\r\n    location: Location,\r\n    matchAs: string\r\n  ): Route {\r\n    const aliasedPath = fillParams(matchAs, location.params, `aliased route with path \"${matchAs}\"`)\r\n    const aliasedMatch = match({\r\n      _normalized: true,\r\n      path: aliasedPath\r\n    })\r\n    if (aliasedMatch) {\r\n      const matched = aliasedMatch.matched\r\n      const aliasedRecord = matched[matched.length - 1]\r\n      location.params = aliasedMatch.params\r\n      return _createRoute(aliasedRecord, location)\r\n    }\r\n    return _createRoute(null, location)\r\n  }\r\n\r\n  function _createRoute (  // \u521b\u5efa\u8def\u7531\r\n    record: ?RouteRecord,\r\n    location: Location,\r\n    redirectedFrom?: Location\r\n  ): Route {\r\n    if (record && record.redirect) {\r\n      return redirect(record, redirectedFrom || location)\r\n    }\r\n    if (record && record.matchAs) {\r\n      return alias(record, location, record.matchAs)\r\n    }\r\n    return createRoute(record, location, redirectedFrom, router) // \u521b\u5efa\u8def\u7531\u5bf9\u8c61\r\n  }\r\n\r\n  return {\r\n    match,\r\n    addRoutes\r\n  }\r\n}\r\n\r\n// dev/src/create-route-map.js line 7\r\nexport function createRouteMap (\r\n  routes: Array<RouteConfig>,\r\n  oldPathList?: Array<string>,\r\n  oldPathMap?: Dictionary<RouteRecord>,\r\n  oldNameMap?: Dictionary<RouteRecord>\r\n): {\r\n  pathList: Array<string>,\r\n  pathMap: Dictionary<RouteRecord>,\r\n  nameMap: Dictionary<RouteRecord>\r\n} {\r\n  // the path list is used to control path matching priority\r\n  const pathList: Array<string> = oldPathList || [] // \u521b\u5efa\u6620\u5c04\u8868\r\n  // $flow-disable-line\r\n  const pathMap: Dictionary<RouteRecord> = oldPathMap || Object.create(null)\r\n  // $flow-disable-line\r\n  const nameMap: Dictionary<RouteRecord> = oldNameMap || Object.create(null)\r\n\r\n  routes.forEach(route => { // \u904d\u5386\u8def\u7531\u914d\u7f6e\uff0c\u4e3a\u6bcf\u4e2a\u914d\u7f6e\u6dfb\u52a0\u8def\u7531\u8bb0\u5f55\r\n    addRouteRecord(pathList, pathMap, nameMap, route)\r\n  })\r\n\r\n  // ensure wildcard routes are always at the end\r\n  for (let i = 0, l = pathList.length; i < l; i++) { // \u786e\u4fdd\u901a\u914d\u7b26\u5728\u6700\u540e\r\n    if (pathList[i] === '*') {\r\n      pathList.push(pathList.splice(i, 1)[0])\r\n      l--\r\n      i--\r\n    }\r\n  }\r\n\r\n  if (process.env.NODE_ENV === 'development') {\r\n    // warn if routes do not include leading slashes\r\n    const found = pathList\r\n    // check for missing leading slash\r\n      .filter(path => path && path.charAt(0) !== '*' && path.charAt(0) !== '/')\r\n\r\n    if (found.length > 0) {\r\n      const pathNames = found.map(path => `- ${path}`).join('\\n')\r\n      warn(false, `Non-nested routes must include a leading slash character. Fix the following routes: \\n${pathNames}`)\r\n    }\r\n  }\r\n\r\n  return {\r\n    pathList,\r\n    pathMap,\r\n    nameMap\r\n  }\r\n}\r\n\r\nfunction addRouteRecord ( // \u6dfb\u52a0\u8def\u7531\u8bb0\u5f55\r\n  pathList: Array<string>,\r\n  pathMap: Dictionary<RouteRecord>,\r\n  nameMap: Dictionary<RouteRecord>,\r\n  route: RouteConfig,\r\n  parent?: RouteRecord,\r\n  matchAs?: string\r\n) {\r\n  const { path, name } = route // \u83b7\u5f97\u8def\u7531\u914d\u7f6e\u4e0b\u7684\u5c5e\u6027\r\n  if (process.env.NODE_ENV !== 'production') {\r\n    assert(path != null, `\"path\" is required in a route configuration.`)\r\n    assert(\r\n      typeof route.component !== 'string',\r\n      `route config \"component\" for path: ${String(\r\n        path || name\r\n      )} cannot be a ` + `string id. Use an actual component instead.`\r\n    )\r\n  }\r\n\r\n  const pathToRegexpOptions: PathToRegexpOptions =\r\n    route.pathToRegexpOptions || {}\r\n  const normalizedPath = normalizePath(path, parent, pathToRegexpOptions.strict)\r\n\r\n  if (typeof route.caseSensitive === 'boolean') {\r\n    pathToRegexpOptions.sensitive = route.caseSensitive\r\n  }\r\n\r\n  const record: RouteRecord = { // \u751f\u6210\u8bb0\u5f55\u5bf9\u8c61\r\n    path: normalizedPath,\r\n    regex: compileRouteRegex(normalizedPath, pathToRegexpOptions),\r\n    components: route.components || { default: route.component },\r\n    instances: {},\r\n    name,\r\n    parent,\r\n    matchAs,\r\n    redirect: route.redirect,\r\n    beforeEnter: route.beforeEnter,\r\n    meta: route.meta || {},\r\n    props:\r\n      route.props == null\r\n        ? {}\r\n        : route.components\r\n          ? route.props\r\n          : { default: route.props }\r\n  }\r\n\r\n  if (route.children) { \r\n    // Warn if route is named, does not redirect and has a default child route.\r\n    // If users navigate to this route by name, the default child will\r\n    // not be rendered (GH Issue #629)\r\n    if (process.env.NODE_ENV !== 'production') {\r\n      if (\r\n        route.name &&\r\n        !route.redirect &&\r\n        route.children.some(child => /^\\/?$/.test(child.path))\r\n      ) {\r\n        warn(\r\n          false,\r\n          `Named Route '${route.name}' has a default child route. ` +\r\n            `When navigating to this named route (:to=\"{name: '${\r\n              route.name\r\n            }'\"), ` +\r\n            `the default child route will not be rendered. Remove the name from ` +\r\n            `this route and use the name of the default child route for named ` +\r\n            `links instead.`\r\n        )\r\n      }\r\n    }\r\n    route.children.forEach(child => { // \u9012\u5f52\u8def\u7531\u914d\u7f6e\u7684 children \u5c5e\u6027\uff0c\u6dfb\u52a0\u8def\u7531\u8bb0\u5f55\r\n      const childMatchAs = matchAs\r\n        ? cleanPath(`${matchAs}/${child.path}`)\r\n        : undefined\r\n      addRouteRecord(pathList, pathMap, nameMap, child, record, childMatchAs)\r\n    })\r\n  }\r\n\r\n  if (!pathMap[record.path]) { // \u5982\u679c\u6709\u591a\u4e2a\u76f8\u540c\u7684\u8def\u5f84\uff0c\u53ea\u6709\u7b2c\u4e00\u4e2a\u8d77\u4f5c\u7528\uff0c\u540e\u9762\u7684\u4f1a\u88ab\u5ffd\u7565\r\n    pathList.push(record.path)\r\n    pathMap[record.path] = record\r\n  }\r\n\r\n  if (route.alias !== undefined) { // \u5982\u679c\u8def\u7531\u6709\u522b\u540d\u7684\u8bdd\uff0c\u7ed9\u522b\u540d\u4e5f\u6dfb\u52a0\u8def\u7531\u8bb0\u5f55\r\n    const aliases = Array.isArray(route.alias) ? route.alias : [route.alias]\r\n    for (let i = 0; i < aliases.length; ++i) {\r\n      const alias = aliases[i]\r\n      if (process.env.NODE_ENV !== 'production' && alias === path) {\r\n        warn(\r\n          false,\r\n          `Found an alias with the same value as the path: \"${path}\". You have to remove that alias. It will be ignored in development.`\r\n        )\r\n        // skip in dev to make it work\r\n        continue\r\n      }\r\n\r\n      const aliasRoute = {\r\n        path: alias,\r\n        children: route.children\r\n      }\r\n      addRouteRecord(\r\n        pathList,\r\n        pathMap,\r\n        nameMap,\r\n        aliasRoute,\r\n        parent,\r\n        record.path || '/' // matchAs\r\n      )\r\n    }\r\n  }\r\n\r\n  if (name) {\r\n    if (!nameMap[name]) {\r\n      nameMap[name] = record\r\n    } else if (process.env.NODE_ENV !== 'production' && !matchAs) {\r\n      warn(\r\n        false,\r\n        `Duplicate named routes definition: ` +\r\n          `{ name: \"${name}\", path: \"${record.path}\" }`\r\n      )\r\n    }\r\n  }\r\n}\n"})}),"\n",(0,o.jsxs)(e.p,{children:["\u5728\u4e0a\u6587\u7684\u6784\u9020\u51fd\u6570\u4e2d\u5b9e\u4f8b\u5316\u7684",(0,o.jsx)(e.code,{children:"HashHistory"}),"\u5bf9\u8c61\u5c31\u662f\u5bf9\u4e8e",(0,o.jsx)(e.code,{children:"Hash"}),"\u6a21\u5f0f\u4e0b\u7684\u8def\u7531\u7684\u5904\u7406\uff0c\u4e3b\u8981\u662f\u901a\u8fc7\u7ee7\u627f",(0,o.jsx)(e.code,{children:"History"}),"\u5bf9\u8c61\u4ee5\u53ca\u81ea\u8eab\u5b9e\u73b0\u7684\u65b9\u6cd5\u5b8c\u6210\u8def\u7531\uff0c\u4ee5\u53ca\u9488\u5bf9\u4e8e\u4e0d\u652f\u6301",(0,o.jsx)(e.code,{children:"history api"}),"\u7684\u517c\u5bb9\u5904\u7406\uff0c\u4ee5\u53ca\u4fdd\u8bc1\u9ed8\u8ba4\u8fdb\u5165\u7684\u65f6\u5019\u5bf9\u5e94\u7684",(0,o.jsx)(e.code,{children:"Hash"}),"\u503c\u662f\u4ee5",(0,o.jsx)(e.code,{children:"/"}),"\u5f00\u5934\u7684\uff0c\u5982\u679c\u4e0d\u662f\u5219\u66ff\u6362\u3002\u5728\u521d\u59cb\u5316",(0,o.jsx)(e.code,{children:"VueRouter"}),"\u65f6\u8c03\u7528\u7684",(0,o.jsx)(e.code,{children:"init"}),"\u65b9\u6cd5\u8c03\u7528\u4e86\u8def\u7531\u5207\u6362\u4ee5\u53ca\u8c03\u7528\u4e86",(0,o.jsx)(e.code,{children:"setupListeners"}),"\u65b9\u6cd5\u5b9e\u73b0\u4e86\u8def\u7531\u7684\u5207\u6362\u7684\u76d1\u542c\u56de\u8c03\uff0c\u6ce8\u610f\u6b64\u65f6\u5e76\u6ca1\u6709\u5728",(0,o.jsx)(e.code,{children:"HashHistory"}),"\u5bf9\u8c61\u7684\u6784\u9020\u51fd\u6570\u4e2d\u76f4\u63a5\u6dfb\u52a0\u4e8b\u4ef6\u76d1\u542c\uff0c\u8fd9\u662f\u4e3a\u4e86\u4fee\u590d",(0,o.jsx)(e.code,{children:"vuejs/vue-router#725"}),"\u7684\u95ee\u9898\uff0c\u7b80\u8981\u6765\u8bf4\u5c31\u662f\u8bf4\u5982\u679c\u5728",(0,o.jsx)(e.code,{children:"beforeEnter"}),"\u8fd9\u6837\u7684\u94a9\u5b50\u51fd\u6570\u4e2d\u662f\u5f02\u6b65\u7684\u8bdd\uff0c",(0,o.jsx)(e.code,{children:"beforeEnter"}),"\u94a9\u5b50\u5c31\u4f1a\u88ab\u89e6\u53d1\u4e24\u6b21\uff0c\u539f\u56e0\u662f\u56e0\u4e3a\u5728\u521d\u59cb\u5316\u7684\u65f6\u5019\u5982\u679c\u6b64\u65f6\u7684",(0,o.jsx)(e.code,{children:"hash"}),"\u503c\u4e0d\u662f\u4ee5",(0,o.jsx)(e.code,{children:"/"}),"\u5f00\u5934\u7684\u8bdd\u5c31\u4f1a\u8865\u4e0a",(0,o.jsx)(e.code,{children:"#/"}),"\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u4f1a\u89e6\u53d1",(0,o.jsx)(e.code,{children:"hashchange"}),"\u4e8b\u4ef6\uff0c\u6240\u4ee5\u4f1a\u518d\u8d70\u4e00\u6b21\u751f\u547d\u5468\u671f\u94a9\u5b50\uff0c\u4e5f\u5c31\u610f\u5473\u7740\u4f1a\u518d\u6b21\u8c03\u7528",(0,o.jsx)(e.code,{children:"beforeEnter"}),"\u94a9\u5b50\u51fd\u6570\u3002"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-javascript",children:"// dev/src/index.js line 21\r\nexport default class VueRouter {\r\n  //...\r\n  init (app: any /* Vue component instance */) {\r\n    process.env.NODE_ENV !== 'production' &&\r\n      assert(\r\n        install.installed,\r\n        `not installed. Make sure to call \\`Vue.use(VueRouter)\\` ` +\r\n          `before creating root instance.`\r\n      )\r\n\r\n    this.apps.push(app)\r\n\r\n    // set up app destroyed handler\r\n    // https://github.com/vuejs/vue-router/issues/2639\r\n    app.$once('hook:destroyed', () => {\r\n      // clean out app from this.apps array once destroyed\r\n      const index = this.apps.indexOf(app)\r\n      if (index > -1) this.apps.splice(index, 1)\r\n      // ensure we still have a main app or null if no apps\r\n      // we do not release the router so it can be reused\r\n      if (this.app === app) this.app = this.apps[0] || null\r\n\r\n      if (!this.app) this.history.teardown()\r\n    })\r\n\r\n    // main app previously initialized\r\n    // return as we don't need to set up new history listener\r\n    if (this.app) {\r\n      return\r\n    }\r\n\r\n    this.app = app\r\n\r\n    const history = this.history\r\n\r\n    if (history instanceof HTML5History || history instanceof HashHistory) {\r\n      const handleInitialScroll = routeOrError => {\r\n        const from = history.current\r\n        const expectScroll = this.options.scrollBehavior\r\n        const supportsScroll = supportsPushState && expectScroll\r\n\r\n        if (supportsScroll && 'fullPath' in routeOrError) {\r\n          handleScroll(this, routeOrError, from, false)\r\n        }\r\n      }\r\n      const setupListeners = routeOrError => {\r\n        history.setupListeners() // \u521d\u59cb\u5316\u6dfb\u52a0\u4e8b\u4ef6\u76d1\u542c\r\n        handleInitialScroll(routeOrError)\r\n      }\r\n      history.transitionTo( // \u5982\u679c\u9ed8\u8ba4\u9875\uff0c\u9700\u8981\u6839\u636e\u5f53\u524d\u6d4f\u89c8\u5668\u5730\u5740\u680f\u91cc\u7684 path \u6216\u8005 hash \u6765\u6fc0\u6d3b\u5bf9\u5e94\u7684\u8def\u7531\r\n        history.getCurrentLocation(),\r\n        setupListeners,\r\n        setupListeners\r\n      )\r\n    }\r\n\r\n    history.listen(route => {\r\n      this.apps.forEach(app => {\r\n        app._route = route\r\n      })\r\n    })\r\n  }\r\n  //...\r\n}\r\n\r\n// dev/src/history/base.js line 24\r\nexport class History {\r\n  // ...\r\n\r\n  transitionTo (\r\n    location: RawLocation,\r\n    onComplete?: Function,\r\n    onAbort?: Function\r\n  ) {\r\n    let route\r\n    // catch redirect option https://github.com/vuejs/vue-router/issues/3201\r\n    try {\r\n      route = this.router.match(location, this.current) // // \u83b7\u53d6\u5339\u914d\u7684\u8def\u7531\u4fe1\u606f\r\n    } catch (e) {\r\n      this.errorCbs.forEach(cb => {\r\n        cb(e)\r\n      })\r\n      // Exception should still be thrown\r\n      throw e\r\n    }\r\n    const prev = this.current\r\n    this.confirmTransition( // \u786e\u8ba4\u8df3\u8f6c\r\n      route,\r\n      () => {\r\n        this.updateRoute(route) // \u66f4\u65b0\u5f53\u524d route \u5bf9\u8c61\r\n        onComplete && onComplete(route)\r\n        this.ensureURL() // \u5b50\u7c7b\u5b9e\u73b0\u7684\u66f4\u65b0url\u5730\u5740 \u5bf9\u4e8e hash \u6a21\u5f0f\u7684\u8bdd \u5c31\u662f\u66f4\u65b0 hash \u7684\u503c\r\n        this.router.afterHooks.forEach(hook => {\r\n          hook && hook(route, prev)\r\n        })\r\n\r\n        // fire ready cbs once\r\n        if (!this.ready) {\r\n          this.ready = true\r\n          this.readyCbs.forEach(cb => {\r\n            cb(route)\r\n          })\r\n        }\r\n      },\r\n      err => {\r\n        if (onAbort) {\r\n          onAbort(err)\r\n        }\r\n        if (err && !this.ready) {\r\n          // Initial redirection should not mark the history as ready yet\r\n          // because it's triggered by the redirection instead\r\n          // https://github.com/vuejs/vue-router/issues/3225\r\n          // https://github.com/vuejs/vue-router/issues/3331\r\n          if (!isNavigationFailure(err, NavigationFailureType.redirected) || prev !== START) {\r\n            this.ready = true\r\n            this.readyErrorCbs.forEach(cb => {\r\n              cb(err)\r\n            })\r\n          }\r\n        }\r\n      }\r\n    )\r\n  }\r\n\r\n  confirmTransition (route: Route, onComplete: Function, onAbort?: Function) {\r\n    const current = this.current\r\n    this.pending = route\r\n    const abort = err => {\r\n      // changed after adding errors with\r\n      // https://github.com/vuejs/vue-router/pull/3047 before that change,\r\n      // redirect and aborted navigation would produce an err == null\r\n      if (!isNavigationFailure(err) && isError(err)) {\r\n        if (this.errorCbs.length) {\r\n          this.errorCbs.forEach(cb => {\r\n            cb(err)\r\n          })\r\n        } else {\r\n          warn(false, 'uncaught error during route navigation:')\r\n          console.error(err)\r\n        }\r\n      }\r\n      onAbort && onAbort(err)\r\n    }\r\n    const lastRouteIndex = route.matched.length - 1\r\n    const lastCurrentIndex = current.matched.length - 1\r\n    if (\r\n      isSameRoute(route, current) && // \u5982\u679c\u662f\u76f8\u540c\u7684\u8def\u7531\u5c31\u4e0d\u8df3\u8f6c\r\n      // in the case the route map has been dynamically appended to\r\n      lastRouteIndex === lastCurrentIndex &&\r\n      route.matched[lastRouteIndex] === current.matched[lastCurrentIndex]\r\n    ) {\r\n      this.ensureURL()\r\n      return abort(createNavigationDuplicatedError(current, route))\r\n    }\r\n\r\n    const { updated, deactivated, activated } = resolveQueue( // \u901a\u8fc7\u5bf9\u6bd4\u8def\u7531\u89e3\u6790\u51fa\u53ef\u590d\u7528\u7684\u7ec4\u4ef6\uff0c\u9700\u8981\u6e32\u67d3\u7684\u7ec4\u4ef6\uff0c\u5931\u6d3b\u7684\u7ec4\u4ef6\r\n      this.current.matched,\r\n      route.matched\r\n    )\r\n\r\n    const queue: Array<?NavigationGuard> = [].concat( // \u5bfc\u822a\u5b88\u536b\u6570\u7ec4\r\n      // in-component leave guards\r\n      extractLeaveGuards(deactivated),  // \u5931\u6d3b\u7684\u7ec4\u4ef6\u94a9\u5b50\r\n      // global before hooks\r\n      this.router.beforeHooks, // \u5168\u5c40 beforeEach \u94a9\u5b50\r\n      // in-component update hooks\r\n      extractUpdateHooks(updated), // \u5728\u5f53\u524d\u8def\u7531\u6539\u53d8\uff0c\u4f46\u662f\u8be5\u7ec4\u4ef6\u88ab\u590d\u7528\u65f6\u8c03\u7528\r\n      // in-config enter guards\r\n      activated.map(m => m.beforeEnter), // \u9700\u8981\u6e32\u67d3\u7ec4\u4ef6 enter \u5b88\u536b\u94a9\u5b50\r\n      // async components\r\n      resolveAsyncComponents(activated) // \u89e3\u6790\u5f02\u6b65\u8def\u7531\u7ec4\u4ef6\r\n    )\r\n\r\n    const iterator = (hook: NavigationGuard, next) => {\r\n      if (this.pending !== route) { // \u8def\u7531\u4e0d\u76f8\u7b49\u5c31\u4e0d\u8df3\u8f6c\u8def\u7531\r\n        return abort(createNavigationCancelledError(current, route))\r\n      }\r\n      try {\r\n        hook(route, current, (to: any) => { // \u53ea\u6709\u6267\u884c\u4e86\u94a9\u5b50\u51fd\u6570\u4e2d\u7684next\uff0c\u624d\u4f1a\u7ee7\u7eed\u6267\u884c\u4e0b\u4e00\u4e2a\u94a9\u5b50\u51fd\u6570\uff0c\u5426\u5219\u4f1a\u6682\u505c\u8df3\u8f6c\uff0c\u4ee5\u4e0b\u903b\u8f91\u662f\u5728\u5224\u65ad next() \u4e2d\u7684\u4f20\u53c2\r\n          if (to === false) {\r\n            // next(false) -> abort navigation, ensure current URL\r\n            this.ensureURL(true)\r\n            abort(createNavigationAbortedError(current, route))\r\n          } else if (isError(to)) {\r\n            this.ensureURL(true)\r\n            abort(to)\r\n          } else if (\r\n            typeof to === 'string' ||\r\n            (typeof to === 'object' &&\r\n              (typeof to.path === 'string' || typeof to.name === 'string'))\r\n          ) {\r\n            // next('/') or next({ path: '/' }) -> redirect\r\n            abort(createNavigationRedirectedError(current, route))\r\n            if (typeof to === 'object' && to.replace) {\r\n              this.replace(to)\r\n            } else {\r\n              this.push(to)\r\n            }\r\n          } else {\r\n            // confirm transition and pass on the value\r\n            next(to)\r\n          }\r\n        })\r\n      } catch (e) {\r\n        abort(e)\r\n      }\r\n    }\r\n    // ...\r\n  }\r\n  // ...\r\n}\r\n\r\n// dev/src/history/hash.js line 10\r\nexport class HashHistory extends History {\r\n  constructor (router: Router, base: ?string, fallback: boolean) {\r\n    super(router, base)\r\n    // check history fallback deeplinking\r\n    if (fallback && checkFallback(this.base)) {\r\n      return\r\n    }\r\n    ensureSlash()\r\n  }\r\n\r\n  // this is delayed until the app mounts\r\n  // to avoid the hashchange listener being fired too early\r\n  setupListeners () { // \u521d\u59cb\u5316 \u8fd9\u5c06\u5ef6\u8fdf\u5230mounts\u751f\u547d\u5468\u671f \u4ee5\u907f\u514d\u8fc7\u65e9\u89e6\u53d1hashchange\u4fa6\u542c\u5668\r\n    if (this.listeners.length > 0) {\r\n      return\r\n    }\r\n\r\n    const router = this.router\r\n    const expectScroll = router.options.scrollBehavior\r\n    const supportsScroll = supportsPushState && expectScroll\r\n\r\n    if (supportsScroll) {\r\n      this.listeners.push(setupScroll())\r\n    }\r\n\r\n    const handleRoutingEvent = () => {\r\n      const current = this.current\r\n      if (!ensureSlash()) {\r\n        return\r\n      }\r\n      this.transitionTo(getHash(), route => {\r\n        if (supportsScroll) {\r\n          handleScroll(this.router, route, current, true)\r\n        }\r\n        if (!supportsPushState) {\r\n          replaceHash(route.fullPath)\r\n        }\r\n      })\r\n    }\r\n    const eventType = supportsPushState ? 'popstate' : 'hashchange'\r\n    window.addEventListener(\r\n      eventType,\r\n      handleRoutingEvent\r\n    )\r\n    this.listeners.push(() => {\r\n      window.removeEventListener(eventType, handleRoutingEvent)\r\n    })\r\n  }\r\n\r\n  push (location: RawLocation, onComplete?: Function, onAbort?: Function) {\r\n    const { current: fromRoute } = this\r\n    this.transitionTo(\r\n      location,\r\n      route => {\r\n        pushHash(route.fullPath)\r\n        handleScroll(this.router, route, fromRoute, false)\r\n        onComplete && onComplete(route)\r\n      },\r\n      onAbort\r\n    )\r\n  }\r\n\r\n  replace (location: RawLocation, onComplete?: Function, onAbort?: Function) {\r\n    const { current: fromRoute } = this\r\n    this.transitionTo(\r\n      location,\r\n      route => {\r\n        replaceHash(route.fullPath)\r\n        handleScroll(this.router, route, fromRoute, false)\r\n        onComplete && onComplete(route)\r\n      },\r\n      onAbort\r\n    )\r\n  }\r\n\r\n  go (n: number) {\r\n    window.history.go(n)\r\n  }\r\n\r\n  ensureURL (push?: boolean) {\r\n    const current = this.current.fullPath\r\n    if (getHash() !== current) {\r\n      push ? pushHash(current) : replaceHash(current)\r\n    }\r\n  }\r\n\r\n  getCurrentLocation () {\r\n    return getHash()\r\n  }\r\n}\n"})}),"\n",(0,o.jsx)(e.h2,{id:"\u6bcf\u65e5\u4e00\u9898",children:"\u6bcf\u65e5\u4e00\u9898"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{children:"https://github.com/WindrunnerMax/EveryDay\n"})}),"\n",(0,o.jsx)(e.h2,{id:"\u53c2\u8003",children:"\u53c2\u8003"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{children:"https://router.vuejs.org/zh/\r\nhttps://github.com/DDFE/DDFE-blog/issues/9\r\nhttps://juejin.im/post/6844903647378145294\r\nhttps://juejin.im/post/6844904062698127367\r\nhttps://juejin.im/post/6844904018519523335\r\nhttps://juejin.im/post/6844904012630720526\r\nhttps://blog.csdn.net/zlingyun/article/details/83536589\r\nhttps://ustbhuangyi.github.io/vue-analysis/v2/vue-router/install.html#vue-use\r\nhttps://liyucang-git.github.io/2019/08/15/vue-router%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/\n"})})]})}function u(r={}){const{wrapper:e}={...(0,a.R)(),...r.components};return e?(0,o.jsx)(e,{...r,children:(0,o.jsx)(d,{...r})}):d(r)}},8453:(r,e,n)=>{n.d(e,{R:()=>s,x:()=>i});var t=n(6540);const o={},a=t.createContext(o);function s(r){const e=t.useContext(a);return t.useMemo((function(){return"function"==typeof r?r(e):{...e,...r}}),[e,r])}function i(r){let e;return e=r.disableParentContext?"function"==typeof r.components?r.components(o):r.components||o:s(r.components),t.createElement(a.Provider,{value:e},r.children)}}}]);